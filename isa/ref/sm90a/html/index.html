
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7BCXXHYNCD"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-7BCXXHYNCD');
</script>
<h1> Nvidia SM90a Instruction Set Architecture</h1>

Here is a reverse engineered ISA specification for the Nvidia SM90a (Hopper) architecture. It's automatically generated by fuzzing nvdisasm utility.<br>
Source code for the solver will be released soon. Please follow me on <a href="https://x.com/KuterDinel">Twitter</a> for updates.
<br>
<br>

<div id="instruction-index"></div>

<div id="instruction-links" hidden>
<a href="nv_isa/ACQBULK.html">ACQBULK</a><br>
<a href="nv_isa/AL2P.html">AL2P</a><br>
<a href="nv_isa/ALD.html">ALD</a><br>
<a href="nv_isa/ARRIVES.html">ARRIVES</a><br>
<a href="nv_isa/ATOM.html">ATOM</a><br>
<a href="nv_isa/ATOMG.html">ATOMG</a><br>
<a href="nv_isa/ATOMS.html">ATOMS</a><br>
<a href="nv_isa/B2R.html">B2R</a><br>
<a href="nv_isa/BAR.html">BAR</a><br>
<a href="nv_isa/BGMMA.html">BGMMA</a><br>
<a href="nv_isa/BMMA.html">BMMA</a><br>
<a href="nv_isa/BMOV.html">BMOV</a><br>
<a href="nv_isa/BMSK.html">BMSK</a><br>
<a href="nv_isa/BPT.html">BPT</a><br>
<a href="nv_isa/BRA.html">BRA</a><br>
<a href="nv_isa/BREAK.html">BREAK</a><br>
<a href="nv_isa/BREV.html">BREV</a><br>
<a href="nv_isa/BRX.html">BRX</a><br>
<a href="nv_isa/BRXU.html">BRXU</a><br>
<a href="nv_isa/BSSY.html">BSSY</a><br>
<a href="nv_isa/BSYNC.html">BSYNC</a><br>
<a href="nv_isa/CALL.html">CALL</a><br>
<a href="nv_isa/CCTL.html">CCTL</a><br>
<a href="nv_isa/CCTLL.html">CCTLL</a><br>
<a href="nv_isa/CGAERRBAR.html">CGAERRBAR</a><br>
<a href="nv_isa/CS2R.html">CS2R</a><br>
<a href="nv_isa/CSMTEST.html">CSMTEST</a><br>
<a href="nv_isa/DADD.html">DADD</a><br>
<a href="nv_isa/DEPBAR.html">DEPBAR</a><br>
<a href="nv_isa/DFMA.html">DFMA</a><br>
<a href="nv_isa/DMMA.html">DMMA</a><br>
<a href="nv_isa/DMUL.html">DMUL</a><br>
<a href="nv_isa/DSETP.html">DSETP</a><br>
<a href="nv_isa/ELECT.html">ELECT</a><br>
<a href="nv_isa/ENDCOLLECTIVE.html">ENDCOLLECTIVE</a><br>
<a href="nv_isa/ERRBAR.html">ERRBAR</a><br>
<a href="nv_isa/EXIT.html">EXIT</a><br>
<a href="nv_isa/F2F.html">F2F</a><br>
<a href="nv_isa/F2FP.html">F2FP</a><br>
<a href="nv_isa/F2I.html">F2I</a><br>
<a href="nv_isa/F2IP.html">F2IP</a><br>
<a href="nv_isa/FADD.html">FADD</a><br>
<a href="nv_isa/FCHK.html">FCHK</a><br>
<a href="nv_isa/FENCE.html">FENCE</a><br>
<a href="nv_isa/FFMA.html">FFMA</a><br>
<a href="nv_isa/FLO.html">FLO</a><br>
<a href="nv_isa/FMNMX.html">FMNMX</a><br>
<a href="nv_isa/FMUL.html">FMUL</a><br>
<a href="nv_isa/FOOTPRINT.html">FOOTPRINT</a><br>
<a href="nv_isa/FRND.html">FRND</a><br>
<a href="nv_isa/FSEL.html">FSEL</a><br>
<a href="nv_isa/FSET.html">FSET</a><br>
<a href="nv_isa/FSETP.html">FSETP</a><br>
<a href="nv_isa/FSWZADD.html">FSWZADD</a><br>
<a href="nv_isa/GETLMEMBASE.html">GETLMEMBASE</a><br>
<a href="nv_isa/HADD2.html">HADD2</a><br>
<a href="nv_isa/HFMA2.html">HFMA2</a><br>
<a href="nv_isa/HGMMA.html">HGMMA</a><br>
<a href="nv_isa/HMMA.html">HMMA</a><br>
<a href="nv_isa/HMNMX2.html">HMNMX2</a><br>
<a href="nv_isa/HMUL2.html">HMUL2</a><br>
<a href="nv_isa/HSET2.html">HSET2</a><br>
<a href="nv_isa/HSETP2.html">HSETP2</a><br>
<a href="nv_isa/I2F.html">I2F</a><br>
<a href="nv_isa/I2FP.html">I2FP</a><br>
<a href="nv_isa/I2I.html">I2I</a><br>
<a href="nv_isa/I2IP.html">I2IP</a><br>
<a href="nv_isa/IABS.html">IABS</a><br>
<a href="nv_isa/IADD3.html">IADD3</a><br>
<a href="nv_isa/IDP.html">IDP</a><br>
<a href="nv_isa/IGMMA.html">IGMMA</a><br>
<a href="nv_isa/IMAD.html">IMAD</a><br>
<a href="nv_isa/IMMA.html">IMMA</a><br>
<a href="nv_isa/IMNMX.html">IMNMX</a><br>
<a href="nv_isa/IPA.html">IPA</a><br>
<a href="nv_isa/ISBERD.html">ISBERD</a><br>
<a href="nv_isa/ISETP.html">ISETP</a><br>
<a href="nv_isa/JMP.html">JMP</a><br>
<a href="nv_isa/JMX.html">JMX</a><br>
<a href="nv_isa/JMXU.html">JMXU</a><br>
<a href="nv_isa/LD.html">LD</a><br>
<a href="nv_isa/LDC.html">LDC</a><br>
<a href="nv_isa/LDG.html">LDG</a><br>
<a href="nv_isa/LDGDEPBAR.html">LDGDEPBAR</a><br>
<a href="nv_isa/LDGSTS.html">LDGSTS</a><br>
<a href="nv_isa/LDL.html">LDL</a><br>
<a href="nv_isa/LDS.html">LDS</a><br>
<a href="nv_isa/LDSM.html">LDSM</a><br>
<a href="nv_isa/LDTRAM.html">LDTRAM</a><br>
<a href="nv_isa/LEA.html">LEA</a><br>
<a href="nv_isa/LEPC.html">LEPC</a><br>
<a href="nv_isa/LOP3.html">LOP3</a><br>
<a href="nv_isa/MATCH.html">MATCH</a><br>
<a href="nv_isa/MEMBAR.html">MEMBAR</a><br>
<a href="nv_isa/MOV.html">MOV</a><br>
<a href="nv_isa/MOVM.html">MOVM</a><br>
<a href="nv_isa/MUFU.html">MUFU</a><br>
<a href="nv_isa/NANOSLEEP.html">NANOSLEEP</a><br>
<a href="nv_isa/NOP.html">NOP</a><br>
<a href="nv_isa/OUT.html">OUT</a><br>
<a href="nv_isa/P2R.html">P2R</a><br>
<a href="nv_isa/PIXLD.html">PIXLD</a><br>
<a href="nv_isa/PLOP3.html">PLOP3</a><br>
<a href="nv_isa/PMTRIG.html">PMTRIG</a><br>
<a href="nv_isa/POPC.html">POPC</a><br>
<a href="nv_isa/PREEXIT.html">PREEXIT</a><br>
<a href="nv_isa/PRMT.html">PRMT</a><br>
<a href="nv_isa/QGMMA.html">QGMMA</a><br>
<a href="nv_isa/QSPC.html">QSPC</a><br>
<a href="nv_isa/R2P.html">R2P</a><br>
<a href="nv_isa/R2UR.html">R2UR</a><br>
<a href="nv_isa/REDAS.html">REDAS</a><br>
<a href="nv_isa/REDG.html">REDG</a><br>
<a href="nv_isa/REDUX.html">REDUX</a><br>
<a href="nv_isa/RET.html">RET</a><br>
<a href="nv_isa/RPCMOV.html">RPCMOV</a><br>
<a href="nv_isa/S2R.html">S2R</a><br>
<a href="nv_isa/S2UR.html">S2UR</a><br>
<a href="nv_isa/SEL.html">SEL</a><br>
<a href="nv_isa/SETCTAID.html">SETCTAID</a><br>
<a href="nv_isa/SGXT.html">SGXT</a><br>
<a href="nv_isa/SHF.html">SHF</a><br>
<a href="nv_isa/SHFL.html">SHFL</a><br>
<a href="nv_isa/ST.html">ST</a><br>
<a href="nv_isa/STAS.html">STAS</a><br>
<a href="nv_isa/STG.html">STG</a><br>
<a href="nv_isa/STL.html">STL</a><br>
<a href="nv_isa/STS.html">STS</a><br>
<a href="nv_isa/STSM.html">STSM</a><br>
<a href="nv_isa/SUATOM.html">SUATOM</a><br>
<a href="nv_isa/SULD.html">SULD</a><br>
<a href="nv_isa/SUQUERY.html">SUQUERY</a><br>
<a href="nv_isa/SUST.html">SUST</a><br>
<a href="nv_isa/SYNCS.html">SYNCS</a><br>
<a href="nv_isa/TEX.html">TEX</a><br>
<a href="nv_isa/TLD.html">TLD</a><br>
<a href="nv_isa/TLD4.html">TLD4</a><br>
<a href="nv_isa/TMML.html">TMML</a><br>
<a href="nv_isa/TXD.html">TXD</a><br>
<a href="nv_isa/TXQ.html">TXQ</a><br>
<a href="nv_isa/UBLKCP.html">UBLKCP</a><br>
<a href="nv_isa/UBLKPF.html">UBLKPF</a><br>
<a href="nv_isa/UBLKRED.html">UBLKRED</a><br>
<a href="nv_isa/UBMSK.html">UBMSK</a><br>
<a href="nv_isa/UBREV.html">UBREV</a><br>
<a href="nv_isa/UCGABAR_ARV.html">UCGABAR_ARV</a><br>
<a href="nv_isa/UCGABAR_WAIT.html">UCGABAR_WAIT</a><br>
<a href="nv_isa/UCLEA.html">UCLEA</a><br>
<a href="nv_isa/UF2FP.html">UF2FP</a><br>
<a href="nv_isa/UFLO.html">UFLO</a><br>
<a href="nv_isa/UIADD3.html">UIADD3</a><br>
<a href="nv_isa/UIMAD.html">UIMAD</a><br>
<a href="nv_isa/UISETP.html">UISETP</a><br>
<a href="nv_isa/ULDC.html">ULDC</a><br>
<a href="nv_isa/ULEA.html">ULEA</a><br>
<a href="nv_isa/ULEPC.html">ULEPC</a><br>
<a href="nv_isa/ULOP3.html">ULOP3</a><br>
<a href="nv_isa/UMOV.html">UMOV</a><br>
<a href="nv_isa/UP2UR.html">UP2UR</a><br>
<a href="nv_isa/UPLOP3.html">UPLOP3</a><br>
<a href="nv_isa/UPOPC.html">UPOPC</a><br>
<a href="nv_isa/UPRMT.html">UPRMT</a><br>
<a href="nv_isa/UR2UP.html">UR2UP</a><br>
<a href="nv_isa/USEL.html">USEL</a><br>
<a href="nv_isa/USETMAXREG.html">USETMAXREG</a><br>
<a href="nv_isa/USETSHMSZ.html">USETSHMSZ</a><br>
<a href="nv_isa/USGXT.html">USGXT</a><br>
<a href="nv_isa/USHF.html">USHF</a><br>
<a href="nv_isa/UTMACCTL.html">UTMACCTL</a><br>
<a href="nv_isa/UTMACMDFLUSH.html">UTMACMDFLUSH</a><br>
<a href="nv_isa/UTMALDG.html">UTMALDG</a><br>
<a href="nv_isa/UTMAPF.html">UTMAPF</a><br>
<a href="nv_isa/UTMAREDG.html">UTMAREDG</a><br>
<a href="nv_isa/UTMASTG.html">UTMASTG</a><br>
<a href="nv_isa/VABSDIFF.html">VABSDIFF</a><br>
<a href="nv_isa/VABSDIFF4.html">VABSDIFF4</a><br>
<a href="nv_isa/VHMNMX.html">VHMNMX</a><br>
<a href="nv_isa/VIADD.html">VIADD</a><br>
<a href="nv_isa/VIADDMNMX.html">VIADDMNMX</a><br>
<a href="nv_isa/VIMNMX.html">VIMNMX</a><br>
<a href="nv_isa/VIMNMX3.html">VIMNMX3</a><br>
<a href="nv_isa/VOTE.html">VOTE</a><br>
<a href="nv_isa/VOTEU.html">VOTEU</a><br>
<a href="nv_isa/WARPGROUP.html">WARPGROUP</a><br>
<a href="nv_isa/WARPSYNC.html">WARPSYNC</a><br>
<a href="nv_isa/YIELD.html">YIELD</a><br>
</div>

<script>
    (function () {
        const mount = document.getElementById('instruction-index');
        const source = document.getElementById('instruction-links');
        if (!mount || !source) return;

        const CATEGORY_ORDER = [
            'Floating Point Instructions',
            'Integer Instructions',
            'Conversion Instructions',
            'Movement Instructions',
            'Predicate Instructions',
            'Load/Store Instructions',
            'Uniform Datapath Instructions',
            'Warpgroup Instructions',
            'Tensor Memory Access Instructions',
            'Texture Instructions',
            'Surface Instructions',
            'Control Instructions',
            'Miscellaneous Instructions',
        ];

        const TABLE = {
            'Floating Point Instructions': [
                ['FADD', 'FP32 Add'],
                ['FADD32I', 'FP32 Add'],
                ['FCHK', 'Floating-point Range Check'],
                ['FFMA32I', 'FP32 Fused Multiply and Add'],
                ['FFMA', 'FP32 Fused Multiply and Add'],
                ['FMNMX', 'FP32 Minimum/Maximum'],
                ['FMUL', 'FP32 Multiply'],
                ['FMUL32I', 'FP32 Multiply'],
                ['FSEL', 'Floating Point Select'],
                ['FSET', 'FP32 Compare And Set'],
                ['FSETP', 'FP32 Compare And Set Predicate'],
                ['FSWZADD', 'FP32 Swizzle Add'],
                ['MUFU', 'FP32 Multi Function Operation'],
                ['HADD2', 'FP16 Add'],
                ['HADD2_32I', 'FP16 Add'],
                ['HFMA2', 'FP16 Fused Mutiply Add'],
                ['HFMA2_32I', 'FP16 Fused Mutiply Add'],
                ['HMMA', 'Matrix Multiply and Accumulate'],
                ['HMNMX2', 'FP16 Minimum / Maximum'],
                ['HMUL2', 'FP16 Multiply'],
                ['HMUL2_32I', 'FP16 Multiply'],
                ['HSET2', 'FP16 Compare And Set'],
                ['HSETP2', 'FP16 Compare And Set Predicate'],
                ['DADD', 'FP64 Add'],
                ['DFMA', 'FP64 Fused Mutiply Add'],
                ['DMMA', 'Matrix Multiply and Accumulate'],
                ['DMUL', 'FP64 Multiply'],
                ['DSETP', 'FP64 Compare And Set Predicate'],
            ],
            'Integer Instructions': [
                ['BMMA', 'Bit Matrix Multiply and Accumulate'],
                ['BMSK', 'Bitfield Mask'],
                ['BREV', 'Bit Reverse'],
                ['FLO', 'Find Leading One'],
                ['IABS', 'Integer Absolute Value'],
                ['IADD', 'Integer Addition'],
                ['IADD3', '3-input Integer Addition'],
                ['IADD32I', 'Integer Addition'],
                ['IDP', 'Integer Dot Product and Accumulate'],
                ['IDP4A', 'Integer Dot Product and Accumulate'],
                ['IMAD', 'Integer Multiply And Add'],
                ['IMMA', 'Integer Matrix Multiply and Accumulate'],
                ['IMNMX', 'Integer Minimum/Maximum'],
                ['IMUL', 'Integer Multiply'],
                ['IMUL32I', 'Integer Multiply'],
                ['ISCADD', 'Scaled Integer Addition'],
                ['ISCADD32I', 'Scaled Integer Addition'],
                ['ISETP', 'Integer Compare And Set Predicate'],
                ['LEA', 'LOAD Effective Address'],
                ['LOP', 'Logic Operation'],
                ['LOP3', 'Logic Operation'],
                ['LOP32I', 'Logic Operation'],
                ['POPC', 'Population count'],
                ['SHF', 'Funnel Shift'],
                ['SHL', 'Shift Left'],
                ['SHR', 'Shift Right'],
                ['VABSDIFF', 'Absolute Difference'],
                ['VABSDIFF4', 'Absolute Difference'],
                ['VHMNMX', 'SIMD FP16 3-Input Minimum / Maximum'],
                ['VIADD', 'SIMD Integer Addition'],
                ['VIADDMNMX', 'SIMD Integer Addition and Fused Min/Max Comparison'],
                ['VIMNMX', 'SIMD Integer Minimum / Maximum'],
                ['VIMNMX3', 'SIMD Integer 3-Input Minimum / Maximum'],
            ],
            'Conversion Instructions': [
                ['F2F', 'Floating Point To Floating Point Conversion'],
                ['F2I', 'Floating Point To Integer Conversion'],
                ['I2F', 'Integer To Floating Point Conversion'],
                ['I2I', 'Integer To Integer Conversion'],
                ['I2IP', 'Integer To Integer Conversion and Packing'],
                ['I2FP', 'Integer to FP32 Convert and Pack'],
                ['F2IP', 'FP32 Down-Convert to Integer and Pack'],
                ['FRND', 'Round To Integer'],
            ],
            'Movement Instructions': [
                ['MOV', 'Move'],
                ['MOV32I', 'Move'],
                ['MOVM', 'Move Matrix with Transposition or Expansion'],
                ['PRMT', 'Permute Register Pair'],
                ['SEL', 'Select Source with Predicate'],
                ['SGXT', 'Sign Extend'],
                ['SHFL', 'Warp Wide Register Shuffle'],
            ],
            'Predicate Instructions': [
                ['PLOP3', 'Predicate Logic Operation'],
                ['PSETP', 'Combine Predicates and Set Predicate'],
                ['P2R', 'Move Predicate Register To Register'],
                ['R2P', 'Move Register To Predicate Register'],
            ],
            'Load/Store Instructions': [
                ['FENCE', 'Memory Visibility Guarantee for Shared or Global Memory'],
                ['LD', 'Load from generic Memory'],
                ['LDC', 'Load Constant'],
                ['LDG', 'Load from Global Memory'],
                ['LDGDEPBAR', 'Global Load Dependency Barrier'],
                ['LDGMC', 'Reducing Load'],
                ['LDGSTS', 'Asynchronous Global to Shared Memcopy'],
                ['LDL', 'Load within Local Memory Window'],
                ['LDS', 'Load within Shared Memory Window'],
                ['LDSM', 'Load Matrix from Shared Memory with Element Size Expansion'],
                ['STSM', 'Store Matrix to Shared Memory'],
                ['ST', 'Store to Generic Memory'],
                ['STG', 'Store to Global Memory'],
                ['STL', 'Store to Local Memory'],
                ['STS', 'Store to Shared Memory'],
                ['STAS', 'Asynchronous Store to Distributed Shared Memory With Explicit Synchronization'],
                ['SYNCS', 'Sync Unit'],
                ['MATCH', 'Match Register Values Across Thread Group'],
                ['QSPC', 'Query Space'],
                ['ATOM', 'Atomic Operation on Generic Memory'],
                ['ATOMS', 'Atomic Operation on Shared Memory'],
                ['ATOMG', 'Atomic Operation on Global Memory'],
                ['REDAS', 'Asynchronous Reduction on Distributed Shared Memory With Explicit Synchronization'],
                ['REDG', 'Reduction Operation on Generic Memory'],
                ['CCTL', 'Cache Control'],
                ['CCTLL', 'Cache Control'],
                ['ERRBAR', 'Error Barrier'],
                ['MEMBAR', 'Memory Barrier'],
                ['CCTLT', 'Texture Cache Control'],
            ],
            'Uniform Datapath Instructions': [
                ['R2UR', 'Move from Vector Register to a Uniform Register'],
                ['REDUX', 'Reduction of a Vector Register into a Uniform Register'],
                ['S2UR', 'Move Special Register to Uniform Register'],
                ['UBMSK', 'Uniform Bitfield Mask'],
                ['UBREV', 'Uniform Bit Reverse'],
                ['UCGABAR_ARV', 'CGA Barrier Synchronization'],
                ['UCGABAR_WAIT', 'CGA Barrier Synchronization'],
                ['UCLEA', 'Load Effective Address for a Constant'],
                ['UF2FP', 'Uniform FP32 Down-convert and Pack'],
                ['UFLO', 'Uniform Find Leading One'],
                ['UIADD3', 'Uniform Integer Addition'],
                ['UIADD3.64', 'Uniform Integer Addition'],
                ['UIMAD', 'Uniform Integer Multiplication'],
                ['UISETP', 'Integer Compare and Set Uniform Predicate'],
                ['ULDC', 'Load from Constant Memory into a Uniform Register'],
                ['ULEA', 'Uniform Load Effective Address'],
                ['ULEPC', 'Uniform Load Effective PC'],
                ['ULOP', 'Logic Operation'],
                ['ULOP3', 'Logic Operation'],
                ['ULOP32I', 'Logic Operation'],
                ['UMOV', 'Uniform Move'],
                ['UP2UR', 'Uniform Predicate to Uniform Register'],
                ['UPLOP3', 'Uniform Predicate Logic Operation'],
                ['UPOPC', 'Uniform Population Count'],
                ['UPRMT', 'Uniform Byte Permute'],
                ['UPSETP', 'Uniform Predicate Logic Operation'],
                ['UR2UP', 'Uniform Register to Uniform Predicate'],
                ['USEL', 'Uniform Select'],
                ['USETMAXREG', 'Release, Deallocate and Allocate Registers'],
                ['USGXT', 'Uniform Sign Extend'],
                ['USHF', 'Uniform Funnel Shift'],
                ['USHL', 'Uniform Left Shift'],
                ['USHR', 'Uniform Right Shift'],
                ['VOTEU', 'Voting across SIMD Thread Group with Results in Uniform Destination'],
            ],
            'Warpgroup Instructions': [
                ['BGMMA', 'Bit Matrix Multiply and Accumulate Across Warps'],
                ['HGMMA', 'Matrix Multiply and Accumulate Across a Warpgroup'],
                ['IGMMA', 'Integer Matrix Multiply and Accumulate Across a Warpgroup'],
                ['QGMMA', 'FP8 Matrix Multiply and Accumulate Across a Warpgroup'],
                ['WARPGROUP', 'Warpgroup Synchronization'],
                ['WARPGROUPSET', 'Set Warpgroup Counters'],
            ],
            'Tensor Memory Access Instructions': [
                ['UBLKCP', 'Bulk Data Copy'],
                ['UBLKPF', 'Bulk Data Prefetch'],
                ['UBLKRED', 'Bulk Data Copy from Shared Memory with Reduction'],
                ['UTMACCTL', 'TMA Cache Control'],
                ['UTMACMDFLUSH', 'TMA Command Flush'],
                ['UTMALDG', 'Tensor Load from Global to Shared Memory'],
                ['UTMAPF', 'Tensor Prefetch'],
                ['UTMAREDG', 'Tensor Store from Shared to Global Memory with Reduction'],
                ['UTMASTG', 'Tensor Store from Shared to Global Memory'],
            ],
            'Texture Instructions': [
                ['TEX', 'Texture Fetch'],
                ['TLD', 'Texture Load'],
                ['TLD4', 'Texture Load 4'],
                ['TMML', 'Texture MipMap Level'],
                ['TXD', 'Texture Fetch With Derivatives'],
                ['TXQ', 'Texture Query'],
            ],
            'Surface Instructions': [
                ['SUATOM', 'Atomic Op on Surface Memory'],
                ['SULD', 'Surface Load'],
                ['SURED', 'Reduction Op on Surface Memory'],
                ['SUST', 'Surface Store'],
            ],
            'Control Instructions': [
                ['ACQBULK', 'Wait for Bulk Release Status Warp State'],
                ['BMOV', 'Move Convergence Barrier State'],
                ['BPT', 'BreakPoint/Trap'],
                ['BRA', 'Relative Branch'],
                ['BREAK', 'Break out of the Specified Convergence Barrier'],
                ['BRX', 'Relative Branch Indirect'],
                ['BRXU', 'Relative Branch with Uniform Register Based Offset'],
                ['BSSY', 'Barrier Set Convergence Synchronization Point'],
                ['BSYNC', 'Synchronize Threads on a Convergence Barrier'],
                ['CALL', 'Call Function'],
                ['CGAERRBAR', 'CGA Error Barrier'],
                ['ELECT', 'Elect a Leader Thread'],
                ['ENDCOLLECTIVE', 'Reset the MCOLLECTIVE mask'],
                ['EXIT', 'Exit Program'],
                ['JMP', 'Absolute Jump'],
                ['JMX', 'Absolute Jump Indirect'],
                ['JMXU', 'Absolute Jump with Uniform Register Based Offset'],
                ['KILL', 'Kill Thread'],
                ['NANOSLEEP', 'Suspend Execution'],
                ['PREEXIT', 'Dependent Task Launch Hint'],
                ['RET', 'Return From Subroutine'],
                ['RPCMOV', 'PC Register Move'],
                ['WARPSYNC', 'Synchronize Threads in Warp'],
                ['YIELD', 'Yield Control'],
            ],
            'Miscellaneous Instructions': [
                ['B2R', 'Move Barrier To Register'],
                ['BAR', 'Barrier Synchronization'],
                ['CS2R', 'Move Special Register to Register'],
                ['DEPBAR', 'Dependency Barrier'],
                ['GETLMEMBASE', 'Get Local Memory Base Address'],
                ['LEPC', 'Load Effective PC'],
                ['NOP', 'No Operation'],
                ['PMTRIG', 'Performance Monitor Trigger'],
                ['S2R', 'Move Special Register to Register'],
                ['SETCTAID', 'Set CTA ID'],
                ['SETLMEMBASE', 'Set Local Memory Base Address'],
                ['VOTE', 'Vote Across SIMT Thread Group'],
            ],
        };

        const links = Array.from(source.querySelectorAll('a[href]'));
        const opcodeToHref = new Map();
        const duplicates = [];

        for (const a of links) {
            const href = a.getAttribute('href') || '';
            const name = (a.textContent || '').trim();
            const m = href.match(/^nv_isa\/([A-Za-z0-9_]+)\.html$/);
            if (!m) continue;
            const op = m[1];
            if (op !== name) continue;
            if (opcodeToHref.has(op)) {
                duplicates.push(op);
                continue;
            }
            opcodeToHref.set(op, href);
        }

        const listedOps = new Set();
        for (const cat of Object.keys(TABLE)) {
            for (const [op] of TABLE[cat]) listedOps.add(op);
        }

        const allOps = Array.from(opcodeToHref.keys()).sort();
        const missingPagesForTable = [];
        for (const op of Array.from(listedOps).sort()) {
            if (!opcodeToHref.has(op)) missingPagesForTable.push(op);
        }

        const unlistedOps = allOps.filter((op) => !listedOps.has(op));

        function esc(s) {
            return String(s)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
        }

        const out = [];
        out.push('<h2>Instruction Categories</h2>');
        out.push('<p>按 cuda-binary-utilities 分类；每条指令后面的说明来自 cuda-binary-utilities。未出现在 cuda-binary-utilities 中的指令会放在最后的 Unlisted 部分。</p>');

        out.push('<h2>Coverage Check</h2>');
        out.push('<p>index.html 中检测到的指令链接（去重后）：' + allOps.length + '。</p>');
        out.push('<p>cuda-binary-utilities 列出的 opcode 数量：' + listedOps.size + '；其中在 index.html 里缺少链接：' + missingPagesForTable.length + '。</p>');
        if (duplicates.length) {
            out.push('<p><b>index.html 中重复的 opcode</b>：<br>' + esc(duplicates.sort().join(', ')) + '</p>');
        }
        if (missingPagesForTable.length) {
            out.push('<p><b>cuda-binary-utilities 中有但 index.html 未链接</b>：<br>' + esc(missingPagesForTable.join(', ')) + '</p>');
        }
        out.push('<p>index.html 中存在但未出现在 cuda-binary-utilities 的 opcode：' + unlistedOps.length + '。</p>');

        for (const cat of CATEGORY_ORDER) {
            const entries = TABLE[cat];
            if (!entries) continue;

            const present = entries.filter(([op]) => opcodeToHref.has(op));
            const absent = entries.filter(([op]) => !opcodeToHref.has(op));
            if (!present.length && !absent.length) continue;

            out.push('<h2>' + esc(cat) + '</h2>');
            for (const [op, desc] of present) {
                const href = opcodeToHref.get(op);
                out.push('<a href="' + esc(href) + '">' + esc(op) + '</a> - ' + esc(desc) + '<br>');
            }
            for (const [op, desc] of absent) {
                out.push(esc(op) + ' - ' + esc(desc) + ' (missing page/link)<br>');
            }
        }

        if (unlistedOps.length) {
            out.push('<h2>Unlisted (Not In Provided Table)</h2>');
            for (const op of unlistedOps) {
                const href = opcodeToHref.get(op);
                out.push('<a href="' + esc(href) + '">' + esc(op) + '</a><br>');
            }
        }

        mount.innerHTML = out.join('\n');
    })();
</script>